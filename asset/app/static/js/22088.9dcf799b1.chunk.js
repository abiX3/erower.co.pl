(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[22088],{80294:(e,t,r)=>{"use strict";r.d(t,{a:()=>a});var n=r(37984),a=e=>{var{error:t,isTouched:r,value:a}=e;if(r){if(!a)return t?n.InputStatus.INVALID:n.InputStatus.DEFAULT;if(a)return t?n.InputStatus.INVALID:n.InputStatus.VALID}return n.InputStatus.DEFAULT}},22088:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>Ie});var n,a,o=r(4601),i=r.n(o),l=r(86795),s=r(58410),u=r(18813),c=r(54337),d=r(16737),p=r(14839),v=r(63862),f=r(22108),m=r.n(f),y=r(84091),h=r(83091),b=r(11943);function g(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var O,E,x=v.default.div(n||(n=g(["\n    display: flex;\n    align-items: center;\n    justify-content: end;\n    width: 40px;\n    height: 56px;\n"]))),S=(0,v.default)(b.default)(a||(a=g(["\n    ",";\n"])),(e=>{var{theme:t}=e;return"\n        color: ".concat(t.colors.tealPrimary,";\n    ")})),j=e=>{var{reason:t,setSelectedReason:r,reasonMap:n,selectedReason:a}=e;return i().createElement(y.H,{onClick:()=>r(t),key:t.key,renderIcon:()=>n[t.key]?i().createElement(x,null,i().createElement(h.default,null)):t.key===(null===a||void 0===a?void 0:a.key)?i().createElement(x,null,i().createElement(S,null)):null},i().createElement(y.H.Title,null,t.content.reason),t.content.description&&i().createElement(y.H.SubTitle,null,t.content.description))},P=r(29807),w=r(80294),k=r(89023),T=r(53652),R=(e,t,r,n,a)=>'["level":'.concat(e,',"key":"').concat(t,'","parentKey":"').concat(r,'","path":"').concat(n,'","reportType":"').concat(a,'"]');function M(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var L,_=v.default.div(O||(O=M(["\n    ","\n"])),(e=>{var{theme:t,isValid:r}=e;return"\n        margin: ".concat(t.space[32]," 0 0;\n        display: flex;\n        flex-direction: column;\n        \n        svg {\n          color: ").concat(r?t.colors.tealPrimary:t.colors.redPrimary,";\n        }\n    ")})),D=(0,v.default)(T.Textarea)(E||(E=M(["\n    overflow-y: hidden;\n    ",";\n"])),(e=>{var{theme:t,value:r}=e;return"\n        font-size: ".concat(t.fontSizes[16],";\n        color: ").concat(t.colors.charcoal,";\n        ").concat(r?"":"\n                color: ".concat(t.colors.grey4,";\n                "),"\n    ")})),C=e=>{var{formProps:t,inputLabel:r,inputPlaceholder:n,requiredText:a,limitHelperText:l,characterLimit:s,reason:c}=e,d=i().useRef(null),{values:p,errors:v,touched:f,setFieldTouched:m,handleChange:y,isValid:h}=t;(0,o.useEffect)((()=>{d.current&&d.current.scrollIntoView({behavior:"smooth"})}));var b=(0,w.a)({error:v.text,isTouched:f.text,value:p.text});return i().createElement(_,{isValid:h},i().createElement(P.FormControl,{label:r,controlMessage:i().createElement(k.Paragraph4,null,a)},i().createElement(D,{ref:d,name:"text",value:p.text||"",rows:4,onChange:e=>{y(e),m("text",!0)},characterLimit:s,placeholder:n,characterLimitHelperText:l,helperText:a,status:b,onFocus:()=>{var e={touch_point_button:R(c.level,c.key,c.parentKey,c.path,c.reportType)};u.ap.trackEvent(u._L.events.adReportTextFieldSelected,e)}})))};var I,K,V,A,F=e=>{var{reason:t,formProps:r,updateState:n}=e,a=(0,l.useIntl)(),s=t.userNote.required;return(0,o.useEffect)((()=>{n({isSubmitting:r.isSubmitting,errors:r.errors,touched:r.touched})}),[r.isSubmitting,r.errors,r.touched,n]),i().createElement(N,{onSubmit:r.handleSubmit,id:"reportForm",name:"reportForm"},i().createElement(C,{characterLimit:t.userNote.maxText,formProps:r,inputLabel:a.formatMessage({id:"moderation.abuse.pleaseExplain"}).concat(s?" *":""),inputPlaceholder:a.formatMessage({id:"moderation.abuse.reasonText.placeholder"}),limitHelperText:t.userNote.minText>0?a.formatMessage({id:"moderation.abuse.characterLimit"},{characters:t.userNote.minText}):"",requiredText:s?a.formatMessage({id:"moderation.abuse.requiredText"}):"",reason:t}))},N=v.default.form(L||(I=[""],K||(K=I.slice(0)),L=Object.freeze(Object.defineProperties(I,{raw:{value:Object.freeze(K)}}))));function z(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function B(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?z(Object(r),!0).forEach((function(t){H(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):z(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function H(e,t,r){return(t=function(e){var t=function(e,t){if("object"!==typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function q(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var U,Z,G,J,Q=v.default.ul(V||(V=q(["\n    width: 100%;\n    list-style: none;\n    margin: ",";\n    padding: ",";\n"])),(e=>{var{theme:t}=e;return t.space[0]}),(e=>{var{theme:t}=e;return t.space[0]})),W=v.default.div(A||(A=q(["\n    margin-top: -",";\n"])),(e=>{var{theme:t}=e;return t.space[24]})),X=e=>{var{setMultilevelFormState:t,onSubmit:r,reasonMap:n,selectedReason:a,setSelectedReason:l,intl:s}=e,u=(0,o.useCallback)((e=>{t({isSubmitting:e.isSubmitting,touched:e.touched,errors:e.errors})}),[t]);return i().createElement(W,null,i().createElement(Q,null,e.reasons.map((e=>i().createElement(j,{key:e.key,reason:e,setSelectedReason:l,reasonMap:n,selectedReason:a})))),(null===a||void 0===a?void 0:a.userNote.visible)&&i().createElement(p.J9,{validate:t=>{var{intl:r,selectedReason:{userNote:{minText:n,maxText:a,required:o}}}=e,i={};return i=B(B({},i),((e,t,r,n,a)=>{var o={},i=m()(e,"text","").trim().length;return n&&!i?o.text=a.formatMessage({id:"moderation.abuse.requiredText",defaultMessage:"Text is required"}):i&&t&&i<t?o.text=a.formatMessage({id:"moderation.abuse.toShortText",defaultMessage:"Text is to short"},{count:t}):i&&r&&i>r&&(o.text=a.formatMessage({id:"moderation.abuse.toLongText",defaultMessage:"Text is to long"},{count:r})),o})(t,n,a,o,r))},onSubmit:r,initialValues:{text:"",reason:null},validateOnChange:!0},(e=>i().createElement(F,{reason:a,formProps:e,updateState:u}))))},Y=r(73153),$=r(40541),ee=r(81763),te=r(43621);function re(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var ne,ae,oe,ie,le=v.default.div(U||(U=re(["\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    padding: ",";\n    border-bottom: 1px solid ",";\n"])),(e=>{var{theme:t}=e;return t.space[24]}),(e=>{var{theme:t}=e;return t.colors.grey3})),se=v.default.div(Z||(Z=re(["\n    display: flex;\n    padding-right: ",";\n    &:hover {\n        cursor: pointer;\n    }\n"])),(e=>{var{theme:t}=e;return t.space[24]})),ue=(0,v.default)(se)(G||(G=re(["\n    padding-right: ",";\n"])),(e=>{var{theme:t}=e;return t.space[0]})),ce=v.default.h3(J||(J=re(["\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    margin: 0;\n    padding-left: ",";\n    padding-right: ",";\n"])),(e=>{var{theme:t}=e;return t.space[0]}),(e=>{var{theme:t}=e;return t.space[24]})),de=e=>{var{isDesktopView:t,hasPreviousLevel:r,handlePreviousLevel:n,onClose:a,title:o,intl:l}=e;return i().createElement(le,null,r&&i().createElement(se,{onClick:n},i().createElement($.default,null)),i().createElement(ce,null,o||l.formatMessage({id:"moderation.abuse.pageLabel",defaultMessage:"Report abuse"})),t?i().createElement(ue,{onClick:a},i().createElement(ee.default,{"data-testid":"reportFormClose"})):i().createElement(te.Z,null,i().createElement(ee.default,{"data-testid":"reportFormClose"})))},pe=r(89567),ve=r(10727),fe=r(87991);function me(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var ye=(0,v.default)(pe.default)(ne||(ne=me(["\n    width: 100%;\n    margin-bottom: 0;\n"]))),he=v.default.section(ae||(ae=me(["\n    display: flex;\n    flex-direction: column;\n    padding: ",";\n"])),(e=>{var{theme:t}=e;return"".concat(t.space[12]," ").concat(t.space[24]," ").concat(t.space[24])})),be=v.default.section(oe||(oe=me(["\n    display: flex;\n    height: ",";\n"])),(e=>{var{theme:t}=e;return t.space[24]})),ge=(0,v.default)(fe.P4)(ie||(ie=me(["\n    color: ",";\n    margin-bottom: ",";\n    margin-top: 0;\n    text-align: center;\n"])),(e=>{var{theme:t}=e;return t.colors["text-global-secondary"]}),(e=>{var{theme:t}=e;return t.space[24]})),Oe=e=>e.isReportButtonVisible?i().createElement(he,null,i().createElement(ge,null,i().createElement(ve._H,{id:"moderation.abuse.goodFaithInfo",defaultMessage:"By sending this report, you confirm that you are acting in good faith and that the information you provided is true to the best of your knowledge."})),i().createElement(ye,{mb:16,form:"reportForm",type:"submit",disabled:e.isReportButtonDisabled},i().createElement(ve._H,{id:"moderation.abuse.sendReport",defaultMessage:"Report"}))):i().createElement(be,null),Ee=r(38336),xe=r(70085),Se=r(56394),je=r.n(Se),Pe=r(57424),we=r(94837),ke=r(13235),Te=r(36843);function Re(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Me(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Re(Object(r),!0).forEach((function(t){Le(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Re(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Le(e,t,r){return(t=function(e){var t=function(e,t){if("object"!==typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _e(e,t,r,n,a,o,i){try{var l=e[o](i),s=l.value}catch(u){return void r(u)}l.done?t(s):Promise.resolve(s).then(n,a)}function De(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){_e(o,n,a,i,l,"next",e)}function l(e){_e(o,n,a,i,l,"throw",e)}i(void 0)}))}}var Ce={allReasons:void 0,reasons:void 0,reasonMap:void 0,selectedReason:void 0,title:void 0,level:1},Ie=e=>{var t=(0,l.useIntl)(),[r,n]=(0,o.useState)(Ce),[a,p]=(0,o.useState)(null),[v,f]=(0,o.useState)(null),[m,y]=(0,o.useState)(0),[h,b]=(0,o.useState)({isSubmitting:!1,touched:void 0,errors:void 0}),g=(0,xe.aq)(a||""),{locale:O}=(0,Ee.MG)(),{atlasAuthConfig:{adsReportingAPIUrl:E}}=(0,Ee.MG)(),{isFeatureFlag:x}=(0,Pe.Z)(),{getAuthToken:S}=(0,o.useContext)(Te.Vo);(0,o.useEffect)((()=>{g!==v&&f(g)}),[g,v]);var j=(0,o.useCallback)(function(){var e=De((function*(e,t,r,n,a,o,i){try{return yield s.Nv.get("".concat(n,"reasons"),Me({siteCode:t,lang:r},e&&{variant:e}),{headers:{"Content-Type":"application/json","Accept-Language":O}},!1,!1,!0)}catch(l){(0,c.Jn)(a.formatMessage({id:"error500.title"}),5e3),i||o.goBack()}return null}));return function(t,r,n,a,o,i,l){return e.apply(this,arguments)}}(),[]);(0,o.useEffect)((()=>{(!r.allReasons&&m<1||v&&m<2)&&(y((e=>e+1)),j(v,e.siteCode,e.langISOCode,E,t,e.history,e.isDesktopView||!1).then((e=>{if(e){var t=e.data,r=t.filter((e=>!e.parentKey)),o=(e=>{var t={};return e.forEach((e=>{e.parentKey&&(t[e.parentKey]?t[e.parentKey].push(e):t[e.parentKey]=[e])})),t})(t);n({allReasons:t,reasons:r,reasonMap:o}),a!==e.experiment.id&&p(e.experiment.id)}})))}),[E,e.siteCode,t,e.history,e.isDesktopView,r.allReasons,a,v,j,m]),(0,o.useEffect)((()=>{u.ap.trackPageView(void 0,u._L.pageViews.abuse,{ad_id:String(e.adId)})}),[e.adId]);var P=function(){var t=De((function*(t,n){var{setSubmitting:a}=n,o=r.selectedReason;if(o&&(a(!0),yield w(o,t.text||""))){var{history:i,isDesktopView:l,onSuccess:s}=e;l?null===s||void 0===s||s():i.replace("".concat(e.location.pathname,"/thanks"))}}));return function(e,r){return t.apply(this,arguments)}}(),w=function(){var r=De((function*(r,n){var{adId:o}=e,i=function(){var t=De((function*(){var t={ad_id:o.toString(),site_code:e.siteCode,report_type:r.reportType,path:r.path,text:n,experiment_id:a||void 0,variant:v||void 0},i=yield S(),l=null===i||void 0===i?void 0:i.accessToken;return yield s.Nv.post("".concat(E,"ad-reports"),Me({},t),{headers:Me({"Content-Type":"application/json"},l?{Authorization:"Bearer "+l}:{})})}));return function(){return t.apply(this,arguments)}}(),l=function(){var e=De((function*(){var e={ad_id:o,reason:r.reportType,path:r.path,text:n};return yield s.GE.post("moderation/abuse",Me({},e))}));return function(){return e.apply(this,arguments)}}();try{return x(we.h.decoupleReportAdFromAtlas)?yield i():yield l(),K(u._L.events.adReportSent,r),!0}catch(d){return(0,c.Jn)(t.formatMessage({id:"error500.title"}),5e3),ke.default.captureException(d),!1}}));return function(e,t){return r.apply(this,arguments)}}(),{reasons:k,reasonMap:T,selectedReason:M,title:L,allReasons:_}=r,D=(0,o.useMemo)((()=>M&&T?T[M.key]?T[M.key]:M.parentKey?T[M.parentKey]:k:k),[M,T,k]),C=(0,o.useMemo)((()=>Boolean(M&&((null===T||void 0===T?void 0:T[M.key])||M.parentKey))),[M,T]),I=()=>{if(K(u._L.events.adReportGoBack),null===D||void 0===D?void 0:D.find((e=>e.key===(null===M||void 0===M?void 0:M.key)))){var e=null!==M&&void 0!==M&&M.parentKey?null===_||void 0===_?void 0:_.find((e=>e.key===M.parentKey)):void 0,t=null!==e&&void 0!==e&&e.parentKey?null===_||void 0===_?void 0:_.find((t=>t.key===e.parentKey)):void 0;n((e=>Me(Me({},e),{},{title:null===t||void 0===t?void 0:t.content.reason,selectedReason:t,level:null===t||void 0===t?void 0:t.level})))}else{var r=null!==M&&void 0!==M&&M.parentKey?null===_||void 0===_?void 0:_.find((e=>e.key===M.parentKey)):void 0;n((e=>Me(Me({},e),{},{title:null===r||void 0===r?void 0:r.content.reason,selectedReason:r,level:null===r||void 0===r?void 0:r.level})))}},K=(t,r)=>{var{adId:n}=e,a={ad_id:n};r&&(a[u.Hj.touchPointButton]=R(r.level,r.key,r.parentKey,r.path,r.reportType)),u.ap.trackEvent(t,a)},V=(0,o.useMemo)((()=>{var e=!!(!M||null!==T&&void 0!==T&&T[M.key]||M.userNote.visible&&M.userNote.required)&&(!je()(h.errors)||je()(h.touched));return h.isSubmitting||!M||e}),[M,h.isSubmitting,h.errors,h.touched,T]),A=(0,o.useMemo)((()=>{if(!M||!T)return!1;var{key:e,parentKey:t}=M,r=T.hasOwnProperty(e),n=t&&T.hasOwnProperty(t);return Boolean(!r&&n)}),[M,T]);if(null===k||void 0===k||!k.length)return i().createElement(d.Z,{name:"center"});var{onClose:F,isDesktopView:N=!1}=e;return i().createElement(Y.Modal,{paddingTop:0,bodyScrollable:!0,mobileFullscreen:!N,position:"center",backdropProps:N?{}:{style:{padding:0}},renderHeader:()=>i().createElement(de,{isDesktopView:N,hasPreviousLevel:C,handlePreviousLevel:I,onClose:F,title:L,intl:t}),footer:i().createElement(Oe,{isReportButtonVisible:A,isReportButtonDisabled:V})},i().createElement(X,{selectedReason:M,setSelectedReason:e=>{var t;if(e.key!==(null===(t=r.selectedReason)||void 0===t?void 0:t.key)){var a=null===_||void 0===_?void 0:_.find((t=>t.key===(null===e||void 0===e?void 0:e.parentKey)));K(u._L.events.adReportSelectLevel+e.level,e),n((t=>Me(Me({},t),{},{selectedReason:e,title:a?a.content.reason:e.content.reason,level:e.level})))}},reasons:D,reasonMap:T,intl:t,onSubmit:P,withNav:!N,setMultilevelFormState:b}))}},43621:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n.Z});var n=r(10916)}}]);
//# sourceMappingURL=22088.9dcf799b1.chunk.js.map